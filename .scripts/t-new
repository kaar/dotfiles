#!/usr/bin/env bash
set -o errexit
set -o nounset
set -o pipefail

usage() {
  cat <<EOF
Usage: $(basename "$0") <session-name>

Create or attach to a tmux session (attaches if outside tmux, switches if inside).

Options:
  -h, --help     Show this help message
EOF
}

case "${1:-}" in
  -h|--help|"") usage; [[ -z "${1:-}" ]] && exit 1 || exit 0 ;;
esac

session_name="$1"

tmux has-session -t "$session_name" 2>/dev/null \
  || tmux new-session -ds "$session_name" -c "$HOME"

if [ -z "${TMUX-}" ]; then
    tmux attach-session -t "$session_name"
else
    tmux switch-client -t "$session_name"
fi
